# ğŸï¸ Formula Student Driverless â€” DT ê¸°ë°˜ ì„¼í„°ë¼ì¸ & ìµœì†Œê³¡ë¥ /ìµœì†Œì‹œê°„ ë ˆì´ì‹±ë¼ì¸

ì´ í”„ë¡œì íŠ¸ëŠ” FSDS ë“±ì—ì„œ ìˆ˜ì§‘í•œ **ë‚´/ì™¸ì¸¡ ì½˜(inner/outer) ì¢Œí‘œ**ë¥¼ ì…ë ¥ìœ¼ë¡œ ë°›ì•„,
**Delaunay Triangulation â†’ ê²½ê³„ ì¤‘ì (MST ì •ë ¬) â†’ ìŠ¤í”Œë¼ì¸ ê· ì¼ ì¬ìƒ˜í”Œ â†’ í­/ê¸°í•˜ëŸ‰ ê³„ì‚° â†’ ìµœì†Œê³¡ë¥ /ìµœì†Œì‹œê°„ ë ˆì´ì‹±ë¼ì¸ ìµœì í™”**
ë¥¼ í•œ ë²ˆì— ìˆ˜í–‰í•©ë‹ˆë‹¤. í•µì‹¬ ì² í•™ì€ **ë‹¨ì¼ íŒŒì´í”„ë¼ì¸ + í’ë¶€í•œ CSV ë””ë²„ê·¸ ë¤í”„ + íŠœë‹ ì¹œí™”ì„±**ì…ë‹ˆë‹¤.

---

## âœ¨ ì£¼ìš” ê¸°ëŠ¥
- **DT(Bowyerâ€“Watson)ë§Œ ì‚¬ìš©**: CDT/í´ë¦¬í•‘/í’ˆì§ˆí•„í„° ì—†ì´ ìˆœìˆ˜ Delaunayë¡œ ê²½ëŸ‰Â·ê²¬ê³  êµ¬í˜„
- **ë¼ë²¨-ìƒì´í•œ ê²½ê³„ ì—£ì§€ ì¶”ì¶œ + ê¸¸ì´ ê¸°ë°˜ í•„í„°**(ì¤‘ì•™ê°’ ìŠ¤ì¼€ì¼/ì ˆëŒ€ ìƒí•œ)
- **MST ì§€ë¦„ ê²½ë¡œ ê¸°ë°˜ ì¤‘ì  ìˆœì„œí™”**(k-NN ê·¸ë˜í”„) + **ì˜¤í”ˆ/íë£¨í”„ ë°©í–¥Â·ì‹œì‘ì  ì •í•©**
- **ìì—° 3ì°¨ ìŠ¤í”Œë¼ì¸ + ê· ì¼ arc-length ì¬ìƒ˜í”Œ**
- **ë²•ì„  ë ˆì´ìºìŠ¤íŒ…ìœ¼ë¡œ í­(width) ê³„ì‚°**: centerlineì—ì„œ inner/outerê¹Œì§€ ê±°ë¦¬
- **ìµœì†Œê³¡ë¥ (min-curv) ë ˆì´ì‹±ë¼ì¸**: ê³¡ë¥  ì„ í˜•í™” + íˆ¬ì˜ ê²½ì‚¬ê°•í•˜(PGD, Armijo, box ì œì•½)
- **ìµœì†Œì‹œê°„(min-time) ë ˆì´ì‹±ë¼ì¸**:
  v(s) ì „Â·í›„ì§„ íŒ¨ìŠ¤(ë§ˆì°°ì› + ê³µë ¥Â·êµ¬ë¦„ì €í•­ + íŒŒì›Œë¦¬ë°‹), corner/slow ê°€ì¤‘ìœ¼ë¡œ time-weighted min-curv
- **í’ë¶€í•œ CSV ë¤í”„**: ì¤‘ê°„ ì‚°ì¶œë¬¼/ì†ë„Â·ê°€ì†/ë©íƒ€ì„ ë¹„êµê¹Œì§€ ì „ ë‹¨ê³„ ë¡œê·¸í™”
- **ì˜¤í”ˆ/íë£¨í”„ ëª¨ë‘ ì§€ì›**: í˜„ì¬ ìœ„ì¹˜/í—¤ë”© ë˜ëŠ” ì‹œì‘ ì•µì»¤/í—¤ë”©ìœ¼ë¡œ ìë™ ì •ë ¬

---

## ğŸ§± ì…ë ¥ & ì¶œë ¥
### ì…ë ¥ íŒŒì¼
- inner.csv, outer.csv  (ê° ì¤„: `x,y`, ë‹¨ìœ„ m, í—¤ë” ë¶ˆí•„ìš”)

### ë¹Œë“œ & ì‹¤í–‰
```bash
g++ -std=c++17 -O3 main.cpp -o fsd_path
./fsd_path inner.csv outer.csv centerline.csv
```
- ì„¸ ë²ˆì§¸ ì¸ì `centerline.csv`ëŠ” **ìµœì¢… ì„¼í„°ë¼ì¸** ì €ì¥ ê²½ë¡œì´ë©°,
  í™•ì¥ìë¥¼ ë—€ **ë² ì´ìŠ¤ ì´ë¦„**ìœ¼ë¡œ ê°ì¢… ë””ë²„ê·¸ CSVê°€ í•¨ê»˜ ìƒì„±ë©ë‹ˆë‹¤.

### ì£¼ìš” ì¶œë ¥ íŒŒì¼(ì ‘ë‘ì‚¬: centerline â†’ centerline_*) 
- `centerline.csv` : ìµœì¢… ì„¼í„°ë¼ì¸ ì¢Œí‘œ
- `centerline_with_geom.csv` : s,x,y,heading_rad,curvature,dist_to_inner,dist_to_outer,width,v_kappa_mps
- `*_raceline.csv`, `*_raceline_with_geom.csv`(ìµœì†Œê³¡ë¥ ) : s,x,y,heading_rad,curvature,alpha_last,v_kappa_mps
- `*_mintime_raceline.csv`, `*_mintime_with_geom.csv`(ìµœì†Œì‹œê°„) : s,x,y,heading_rad,curvature,alpha_last,v_mps,ax_mps2
  â†’ ì‹¤í–‰ ë¡œê·¸ì— **ì˜ˆìƒ ë©íƒ€ì„** ì¶œë ¥
- ë””ë²„ê·¸/ì¤‘ê°„ ì‚°ì¶œë¬¼:
  - `*_all_points.csv`(id,x,y,label), `*_tri_raw_idx.csv`(a,b,c)
  - `*_edges_all_idx.csv`, `*_edges_labeldiff_idx.csv`, `*_edges_labeldiff_kept_idx.csv`
  - `*_mids_raw.csv`, `*_mids_ordered.csv`
  - `*_inner_from_mids.csv`, `*_outer_from_mids.csv`
  - `*_debug_compare_paths.csv` : ì„¼í„°/ìµœì†Œê³¡ë¥ /ìµœì†Œì‹œê°„ ì¢Œí‘œÂ·í¸ì°¨Â·ÎºÂ·vÂ·axÂ·ê°€ì¤‘ ë¹„êµ
- íë£¨í”„ + `emit_closed_duplicate=true`ì´ë©´ s=Lì—ì„œ ì²« ì  ì¬ê¸°ë¡(í´ë¡œì¦ˆë“œ í¸ì˜ìš©).

---

## ğŸ§­ íŒŒì´í”„ë¼ì¸ ê°œìš”
1) Delaunay(Bowyerâ€“Watson) ìƒì„± â†’ ì—£ì§€ë§µ êµ¬ì„±
2) ë¼ë²¨-ìƒì´í•œ ê²½ê³„ ì—£ì§€ ì¶”ì¶œ â†’ **ê¸¸ì´ ê¸°ë°˜ í•„í„°** ì ìš©
3) ê²½ê³„ ì—£ì§€ **ì¤‘ì (mids)** ê³„ì‚° â†’ **MST ì§€ë¦„ ê²½ë¡œ**ë¡œ ìˆœì„œí™”
4) **ë°©í–¥/ì‹œì‘ì  ì •í•©**
   - ì˜¤í”ˆ: í˜„ì¬ ìœ„ì¹˜/í—¤ë”©ê³¼ ì •ë ¬, ì‹œì‘ ì•µì»¤ì— ê°€ì¥ ê°€ê¹Œìš´ ì ì„ 0ë²ˆìœ¼ë¡œ íšŒì „
   - íë£¨í”„: ì‹œì‘ ì•µì»¤/í—¤ë”©(ë˜ëŠ” CCW ê°•ì œ) ì •í•© í›„ ì‹œì‘ì  íšŒì „
5) **ìì—° 3ì°¨ ìŠ¤í”Œë¼ì¸ + ê· ì¼ ì¬ìƒ˜í”Œ**(íŒ¨ë”©ìœ¼ë¡œ ê²½ê³„ ì•ˆì •í™”)
6) **í­/ê¸°í•˜ëŸ‰ ê³„ì‚°**: ë²•ì„  ë ˆì´ìºìŠ¤íŠ¸ë¡œ inner/outerê¹Œì§€ ê±°ë¦¬ â†’ í­, v_Îº
7) **ìµœì†Œê³¡ë¥  ë ˆì´ì‹±ë¼ì¸**: Îº ì„ í˜•í™”, PGD+Armijo, ì½”ë¦¬ë„(box) ì œì•½
8) **ìµœì†Œì‹œê°„ ë ˆì´ì‹±ë¼ì¸**: v(s) ì „Â·í›„ì§„ íŒ¨ìŠ¤(ë§ˆì°°ì›, í•­ë ¥/êµ¬ë¦„, íŒŒì›Œë¦¬ë°‹) + corner/slow ê°€ì¤‘ â†’ ë°˜ë³µ

---

## âš™ï¸ ì„¤ì •(íŠœë‹) â€” cfg::Config ì£¼ìš” í•­ëª©
- íŠ¸ë™/ì •ë ¬: `is_closed_track`, `force_closed_ccw`, `current_pos_*`, `current_heading_rad`,
  `start_anchor_*`, `start_heading_rad`, `emit_closed_duplicate`
- ìƒ˜í”Œë§/ì •ë ¬: `use_dynamic_samples`, `sample_factor_n`, `samples_min/max`, `knn_k`
- ê²½ê³„ ì—£ì§€ í•„í„°: `enable_boundary_len_filter`, `boundary_edge_len_scale`, `boundary_edge_abs_max`
- ì°¨ëŸ‰/ì•ˆì „: `veh_width_m`, `safety_margin_m`
- ìµœì í™”: `lambda_smooth`, `max_outer_iters`, `max_inner_iters`, `step_init`, `step_min`, `armijo_c`
- ì œí•œ/ë™ì—­í•™: `kappa_eps`, `v_cap_mps`, `mu`(â†’`a_total_max`), `a_lat_max`,
  `a_long_acc_cap`, `a_long_brake_cap`, `Cd`, `A_front_m2`, `rho_air`, `c_rr`, `P_max_W`, `mass_kg`
- ìµœì†Œì‹œê°„ ê°€ì¤‘: `w_time_gain`, `time_gamma_power`, `time_weight_use_inv_v`, `inv_v_gain`,
  `max_vpass_iters`, `use_total_ge_lat`
- ë””ë²„ê·¸: `verbose`, `debug_dump`, `debug_offset_warn_m`

### íŠœë‹ íŒíŠ¸
- ì½”ë„ˆ ê³µëµâ†‘: `w_time_gainâ†‘` ë˜ëŠ” `lambda_smoothâ†“`(ê³¼ë„ ì‹œ ì§€ê·¸ì¬ê·¸ ì£¼ì˜)
- ì§ì„  ê°€ì† í˜„ì‹¤í™”: `P_max_Wâ†“` ë˜ëŠ” `a_long_acc_capâ†“`, `CdÂ·A`, `c_rr` ë³´ì •
- ê²½ê³„ ê³¼ì ‘ê·¼ ë°©ì§€: `safety_margin_mâ†‘`

---

## ğŸ” ë””ë²„ê¹… & ê²€ì¦
- ë‹¨ê³„ë³„ **íƒ€ì´ë° ë¡œê·¸**: load/dt/mids/mst/spline/geom/mincurv/mintime
- `*_debug_compare_paths.csv`:
  - ì„¼í„°/ìµœì†Œê³¡ë¥ /ìµœì†Œì‹œê°„ì˜ ì¢Œí‘œ, **ë¶€í˜¸ ìˆëŠ” í¸ì°¨**(ì„¼í„°ë¼ì¸ ë²•ì„  ê¸°ì¤€), Îº, v, ax, ê°€ì¤‘ì¹˜ ë“±
  - kappa-limited ë¹„ìœ¨, grad norm, Armijo ë°±íŠ¸ë™ íšŸìˆ˜ ë¡œê·¸

---

## ğŸ“ ì•Œê³ ë¦¬ì¦˜ ë…¸íŠ¸
- **DTë§Œ ì‚¬ìš©**: ë‘ ë§ ê°€ì • í•˜ì—, ë¼ë²¨-ìƒì´í•œ ê²½ê³„ì—£ì§€ì˜ **ì¤‘ì **ì´ íŠ¸ë™ ì¤‘ì•™ ê²½í–¥ ë°˜ì˜
- **í­ ê³„ì‚°**: ìŠ¤í”Œë¼ì¸ ì¬ìƒ˜í”Œ ì¢Œí‘œì—ì„œ ë²•ì„  Â± ë°©í–¥ìœ¼ë¡œ ë§ ì„¸ê·¸ë¨¼íŠ¸ì— **rayâ€“segment** êµì°¨ â†’ ìµœë‹¨ê±°ë¦¬
- **ìµœì†Œê³¡ë¥ **: ìœ í•œì°¨ë¶„ D1/D2 ë° ì „ì¹˜(D1áµ€/D2áµ€)ë¡œ ê·¸ë¼ë””ì–¸íŠ¸ êµ¬ì„± â†’ PGD + Armijo
- **ìµœì†Œì‹œê°„**:
  - `v â‰¤ âˆš(a_lat_max / |Îº|)` + ë§ˆì°°ì›ì—ì„œ ì¢…ê°€ì† ì—¬ìœ  ì‚°ì¶œ
  - ì „ì§„: `v_{i+1} â‰¤ âˆš(v_iÂ² + 2 a_acc h)` / í›„ì§„: `v_i â‰¤ âˆš(v_{i+1}Â² + 2 a_brk h)`
  - **í•­ë ¥/êµ¬ë¦„ì €í•­** ë° **íŒŒì›Œë¦¬ë°‹** ë°˜ì˜ìœ¼ë¡œ í˜„ì‹¤ì„± ê°•í™”

---

## âš ï¸ ì „ì œ & í•œê³„
- ì…ë ¥ ì½˜ì´ **ëŒ€ëµ ë‘ ë§(inner/outer)** ì„ ì´ë£¬ë‹¤ëŠ” ê°€ì •
- **CDT/í´ë¦¬í•‘ ì—†ìŒ**: ì™¸ê³½ ì´ìƒì¹˜ê°€ ë§ìœ¼ë©´ ê²½ê³„ ì—£ì§€ í•„í„° íŒŒë¼ë¯¸í„° íŠœë‹ í•„ìš”
- íë£¨í”„ ì™„ì „ ìŠ¤ëƒ…(ì²«Â·ë ì •í•©)ì´ í•„ìš”í•˜ë©´ í›„ì²˜ë¦¬ ìŠ¤ëƒ… ì˜µì…˜ ì¶”ê°€ ê¶Œì¥

---

## ğŸ—ºï¸ ë¡œë“œë§µ(ì œì•ˆ)
- ì½”ë¦¬ë„ ê°±ì‹  **EMA/í´ë¦½**ìœ¼ë¡œ ìˆ˜ë ´ ì•ˆì •ì„± ì¶”ê°€
- íë£¨í”„ **ì£¼ê¸°(cyclic) ìŠ¤í”Œë¼ì¸** ì˜µì…˜
- `orderIndicesByMST` ë§¤ì¹­ì— **k-d tree** ë„ì…(ëŒ€ê·œëª¨ íŠ¸ë™ ê°€ì†)
- ê²½ê³„ ê·¼ì ‘ **ê°€ì¤‘ í˜ë„í‹° í•­**(ì•ˆì „ ì—¬ìœ  ë°˜ì˜)

---

## ğŸ“„ ë¼ì´ì„ ìŠ¤
ì—°êµ¬/í•™ìŠµ ëª©ì  ì˜ˆì œì…ë‹ˆë‹¤. ì‹¤ì œ ì°¨ëŸ‰ ì ìš© ì‹œ ì•ˆì „ í™•ë³´ ë° íŒŒë¼ë¯¸í„° ê²€ì¦ì´ í•„ìˆ˜ì…ë‹ˆë‹¤.

---

## ğŸ™Œ ë¬¸ì˜
PR/ì´ìŠˆë¡œ ì œì•ˆ/í”¼ë“œë°± í™˜ì˜í•©ë‹ˆë‹¤. FSDS/ì‹¤íŠ¸ë™ ë¡œê·¸ì— ë§ì¶˜ íŠœë‹ ê°€ì´ë“œë„ í™˜ì˜í•©ë‹ˆë‹¤.
